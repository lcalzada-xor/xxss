=== RUN   TestDOMClobberingFalsePositives
=== RUN   TestDOMClobberingFalsePositives/Unused_ID_(Sensitive_Name)_-_Should_be_ignored
=== RUN   TestDOMClobberingFalsePositives/Used_ID_-_Should_be_found
=== RUN   TestDOMClobberingFalsePositives/Used_ID_via_window_-_Should_be_found
=== RUN   TestDOMClobberingFalsePositives/Unused_ID_(Non-Sensitive)_-_Should_be_ignored
--- PASS: TestDOMClobberingFalsePositives (0.00s)
    --- PASS: TestDOMClobberingFalsePositives/Unused_ID_(Sensitive_Name)_-_Should_be_ignored (0.00s)
    --- PASS: TestDOMClobberingFalsePositives/Used_ID_-_Should_be_found (0.00s)
    --- PASS: TestDOMClobberingFalsePositives/Used_ID_via_window_-_Should_be_found (0.00s)
    --- PASS: TestDOMClobberingFalsePositives/Unused_ID_(Non-Sensitive)_-_Should_be_ignored (0.00s)
=== RUN   TestDeduplicateFindings
--- PASS: TestDeduplicateFindings (0.00s)
=== RUN   TestEvidencePopulation
    evidence_test.go:17: Expected evidence ' href="javascript:alert(1)"', got ''
    evidence_test.go:41: AST Evidence: {
        			dangerouslySetInnerHTML: { __html: taint }
        		}
--- FAIL: TestEvidencePopulation (0.00s)
=== RUN   TestDOMScanner_Extended
=== RUN   TestDOMScanner_Extended/postMessage:_event.data_to_innerHTML

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (121 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: Visiting node type: *ast.FunctionLiteral
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.AssignExpression
[VV] DOM: Visiting AssignExpression
[VV] DOM: Checking assignment to 'document.getElementById().innerHTML'
[VV] DOM: 'document.getElementById().innerHTML' matched sink pattern 'innerHTML'
[VV] DOM: Detected sink assignment to 'document.getElementById().innerHTML'
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: CallExpression callee resolved to: document.getElementById
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Found addEventListener call
[VV] DOM: Found 'message' event listener. Tainting param 'e' as 'event.data'
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.AssignExpression
[VV] DOM: Visiting AssignExpression
[VV] DOM: Checking assignment to 'document.getElementById().innerHTML'
[VV] DOM: 'document.getElementById().innerHTML' matched sink pattern 'innerHTML'
[VV] DOM: Detected sink assignment to 'document.getElementById().innerHTML'
[VV] DOM: lookupTaint('e') found 'event.data' in scope 1
[VV] DOM: SINK DETECTED! document.getElementById().innerHTML = tainted var 'e' (property access) from event.data (line 3)
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: CallExpression callee resolved to: document.getElementById
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Missing origin validation in message listener
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 3 potential global accesses: map[addEventListener:true document:true window:true]
=== RUN   TestDOMScanner_Extended/postMessage:_event.data_to_innerHTML_(Arrow_Function)

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (99 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: Visiting node type: *ast.ArrowFunctionLiteral
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.AssignExpression
[VV] DOM: Visiting AssignExpression
[VV] DOM: Checking assignment to 'document.body.innerHTML'
[VV] DOM: 'document.body.innerHTML' matched sink pattern 'innerHTML'
[VV] DOM: Detected sink assignment to 'document.body.innerHTML'
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Found addEventListener call
[VV] DOM: Found 'message' event listener. Tainting param 'e' as 'event.data'
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.AssignExpression
[VV] DOM: Visiting AssignExpression
[VV] DOM: Checking assignment to 'document.body.innerHTML'
[VV] DOM: 'document.body.innerHTML' matched sink pattern 'innerHTML'
[VV] DOM: Detected sink assignment to 'document.body.innerHTML'
[VV] DOM: lookupTaint('e') found 'event.data' in scope 1
[VV] DOM: SINK DETECTED! document.body.innerHTML = tainted var 'e' (property access) from event.data (line 3)
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Missing origin validation in message listener
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 2 potential global accesses: map[addEventListener:true window:true]
=== RUN   TestDOMScanner_Extended/postMessage:_Safe_usage_(console.log)

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (91 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: Visiting node type: *ast.FunctionLiteral
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: console.log
[VV] DOM: Found addEventListener call
[VV] DOM: Found 'message' event listener. Tainting param 'e' as 'event.data'
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: console.log
[VV] DOM: Missing origin validation in message listener
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 3 potential global accesses: map[addEventListener:true console:true window:true]
=== RUN   TestDOMScanner_Extended/React:_dangerouslySetInnerHTML

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (133 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.Binding
[VV] DOM: Variable 'user_input' tainted from 'location.search'
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.Binding
[VV] DOM: Visiting node type: *ast.ObjectLiteral
[VV] DOM: lookupTaint('user_input') found 'location.search' in scope 0
[VV] DOM: Visiting node type: *ast.ObjectLiteral
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 1 potential global accesses: map[location:true]
=== RUN   TestDOMScanner_Extended/AngularJS:_$compile

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (63 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.Binding
[VV] DOM: Variable 'input' tainted from 'location.hash'
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: lookupTaint('input') found 'location.hash' in scope 0
[VV] DOM: Function '$compile' called with tainted arg[0] ('input') from 'location.hash'
[VV] DOM: CallExpression callee resolved to: $compile
[VV] DOM: lookupTaint('input') found 'location.hash' in scope 0
[VV] DOM: SINK DETECTED! $compile() called with location.hash (line 3)
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: $compile()
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 3 potential global accesses: map[$compile:true location:true scope:true]
=== RUN   TestDOMScanner_Extended/AngularJS:_$sce.trustAsHtml

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (64 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.Binding
[VV] DOM: Variable 'html' tainted from 'location.search'
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: $sce.trustAsHtml
[VV] DOM: lookupTaint('html') found 'location.search' in scope 0
[VV] DOM: SINK DETECTED! $sce.trustAsHtml() called with location.search (line 3)
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 2 potential global accesses: map[$sce:true location:true]
=== RUN   TestDOMScanner_Extended/Bare_addEventListener_(no_window_prefix)

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (87 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: Visiting node type: *ast.FunctionLiteral
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: document.write
[VV] DOM: Found addEventListener call
[VV] DOM: Found 'message' event listener. Tainting param 'e' as 'event.data'
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: document.write
[VV] DOM: lookupTaint('e') found 'event.data' in scope 1
[VV] DOM: SINK DETECTED! document.write() called with event.data (line 3)
[VV] DOM: Missing origin validation in message listener
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 2 potential global accesses: map[addEventListener:true document:true]
=== RUN   TestDOMScanner_Extended/HTML_Event_Handler:_onerror

[VV] === DOM XSS Scan ===
[VV] DOM: Found event handler 'onerror' with code: document.write(location.search)
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (31 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: document.write
[VV] DOM: SINK DETECTED! document.write() called with location.search (line 1)
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 2 potential global accesses: map[document:true location:true]
=== RUN   TestDOMScanner_Extended/HTML_Event_Handler:_onload

[VV] === DOM XSS Scan ===
[VV] DOM: Found event handler 'onload' with code: var x = location.hash; eval(x)
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (30 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.Binding
[VV] DOM: Variable 'x' tainted from 'location.hash'
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: lookupTaint('x') found 'location.hash' in scope 0
[VV] DOM: Function 'eval' called with tainted arg[0] ('x') from 'location.hash'
[VV] DOM: CallExpression callee resolved to: eval
[VV] DOM: lookupTaint('x') found 'location.hash' in scope 0
[VV] DOM: SINK DETECTED! eval() called with location.hash (line 1)
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 2 potential global accesses: map[eval:true location:true]
=== RUN   TestDOMScanner_Extended/Framework_Directive:_v-html

[VV] === DOM XSS Scan ===
[VV] DOM: Found framework directive 'v-html' with value: location.search
[VV] DOM: SINK DETECTED! Framework directive 'v-html' with source 'location.search'
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (36 bytes)
[VV] DOM: Failed to parse JS: (anonymous): Line 1:1 Unexpected token <
=== RUN   TestDOMScanner_Extended/Framework_Directive:_ng-bind-html

[VV] === DOM XSS Scan ===
[VV] DOM: Found framework directive 'ng-bind-html' with value: document.cookie
[VV] DOM: SINK DETECTED! Framework directive 'ng-bind-html' with source 'document.cookie'
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (42 bytes)
[VV] DOM: Failed to parse JS: (anonymous): Line 1:1 Unexpected token <
=== RUN   TestDOMScanner_Extended/New_Source:_document.baseURI

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (32 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: document.write
[VV] DOM: SINK DETECTED! document.write() called with document.baseURI (line 1)
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 1 potential global accesses: map[document:true]
=== RUN   TestDOMScanner_Extended/New_Sink:_range.createContextualFragment

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (64 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: document.createRange
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: document.createRange().createContextualFragment
[VV] DOM: SINK DETECTED! document.createRange().createContextualFragment() called with location.search (line 1)
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 2 potential global accesses: map[document:true location:true]
=== RUN   TestDOMScanner_Extended/Protocol:_javascript:_in_href

[VV] === DOM XSS Scan ===
[VV] DOM: Found javascript: protocol in href: alert(1)
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (8 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.NumberLiteral
[VV] DOM: CallExpression callee resolved to: alert
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 1 potential global accesses: map[alert:true]
=== RUN   TestDOMScanner_Extended/DOM_Clobbering:_Global_Variable_Shadowing

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (38 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: eval
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 3 potential global accesses: map[config:true eval:true window:true]
[VV] DOM: CONFIRMED DOM Clobbering target: id=config (accessed in JS)
=== RUN   TestDOMScanner_Extended/postMessage:_Missing_Origin_Check

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (66 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: Visiting node type: *ast.FunctionLiteral
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: eval
[VV] DOM: Found addEventListener call
[VV] DOM: Found 'message' event listener. Tainting param 'e' as 'event.data'
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: eval
[VV] DOM: lookupTaint('e') found 'event.data' in scope 1
[VV] DOM: SINK DETECTED! eval() called with event.data (line 1)
[VV] DOM: Missing origin validation in message listener
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 3 potential global accesses: map[addEventListener:true eval:true window:true]
=== RUN   TestDOMScanner_Extended/postMessage:_With_Origin_Check

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (110 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: Visiting node type: *ast.FunctionLiteral
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.IfStatement
[VV] DOM: Visiting node type: *ast.BinaryExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: eval
[VV] DOM: Found addEventListener call
[VV] DOM: Found 'message' event listener. Tainting param 'e' as 'event.data'
[VV] DOM: Found origin validation check
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.IfStatement
[VV] DOM: Visiting node type: *ast.BinaryExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: eval
[VV] DOM: lookupTaint('e') found 'event.data' in scope 1
[VV] DOM: SINK DETECTED! eval() called with event.data (line 1)
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 3 potential global accesses: map[addEventListener:true eval:true window:true]
=== RUN   TestDOMScanner_Extended/Web_Worker:_importScripts

[VV] === DOM XSS Scan ===
[VV] → Found 1 inline script blocks
[VV] Parsing JS block 1 (30 bytes)
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: importScripts
[VV] DOM: SINK DETECTED! importScripts() called with location.search (line 1)
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 2 potential global accesses: map[importScripts:true location:true]
--- PASS: TestDOMScanner_Extended (0.00s)
    --- PASS: TestDOMScanner_Extended/postMessage:_event.data_to_innerHTML (0.00s)
    --- PASS: TestDOMScanner_Extended/postMessage:_event.data_to_innerHTML_(Arrow_Function) (0.00s)
    --- PASS: TestDOMScanner_Extended/postMessage:_Safe_usage_(console.log) (0.00s)
    --- PASS: TestDOMScanner_Extended/React:_dangerouslySetInnerHTML (0.00s)
    --- PASS: TestDOMScanner_Extended/AngularJS:_$compile (0.00s)
    --- PASS: TestDOMScanner_Extended/AngularJS:_$sce.trustAsHtml (0.00s)
    --- PASS: TestDOMScanner_Extended/Bare_addEventListener_(no_window_prefix) (0.00s)
    --- PASS: TestDOMScanner_Extended/HTML_Event_Handler:_onerror (0.00s)
    --- PASS: TestDOMScanner_Extended/HTML_Event_Handler:_onload (0.00s)
    --- PASS: TestDOMScanner_Extended/Framework_Directive:_v-html (0.00s)
    --- PASS: TestDOMScanner_Extended/Framework_Directive:_ng-bind-html (0.00s)
    --- PASS: TestDOMScanner_Extended/New_Source:_document.baseURI (0.00s)
    --- PASS: TestDOMScanner_Extended/New_Sink:_range.createContextualFragment (0.00s)
    --- PASS: TestDOMScanner_Extended/Protocol:_javascript:_in_href (0.00s)
    --- PASS: TestDOMScanner_Extended/DOM_Clobbering:_Global_Variable_Shadowing (0.00s)
    --- PASS: TestDOMScanner_Extended/postMessage:_Missing_Origin_Check (0.00s)
    --- PASS: TestDOMScanner_Extended/postMessage:_With_Origin_Check (0.00s)
    --- PASS: TestDOMScanner_Extended/Web_Worker:_importScripts (0.00s)
=== RUN   TestSourcePatterns
=== RUN   TestSourcePatterns/Location_Search
=== RUN   TestSourcePatterns/Location_Hash
=== RUN   TestSourcePatterns/Document_Cookie
=== RUN   TestSourcePatterns/Safe_String
=== RUN   TestSourcePatterns/No_Match
--- PASS: TestSourcePatterns (0.00s)
    --- PASS: TestSourcePatterns/Location_Search (0.00s)
    --- PASS: TestSourcePatterns/Location_Hash (0.00s)
    --- PASS: TestSourcePatterns/Document_Cookie (0.00s)
    --- PASS: TestSourcePatterns/Safe_String (0.00s)
    --- PASS: TestSourcePatterns/No_Match (0.00s)
=== RUN   TestSinkPatterns
=== RUN   TestSinkPatterns/Eval
=== RUN   TestSinkPatterns/InnerHTML
=== RUN   TestSinkPatterns/Document_Write
=== RUN   TestSinkPatterns/Navigation_API
=== RUN   TestSinkPatterns/Javascript_Protocol
=== RUN   TestSinkPatterns/Safe_Method
--- PASS: TestSinkPatterns (0.00s)
    --- PASS: TestSinkPatterns/Eval (0.00s)
    --- PASS: TestSinkPatterns/InnerHTML (0.00s)
    --- PASS: TestSinkPatterns/Document_Write (0.00s)
    --- PASS: TestSinkPatterns/Navigation_API (0.00s)
    --- PASS: TestSinkPatterns/Javascript_Protocol (0.00s)
    --- PASS: TestSinkPatterns/Safe_Method (0.00s)
=== RUN   TestDOMScanner_PayloadGeneration
=== RUN   TestDOMScanner_PayloadGeneration/innerHTML_Sink
=== RUN   TestDOMScanner_PayloadGeneration/eval_Sink
=== RUN   TestDOMScanner_PayloadGeneration/location_Sink
=== RUN   TestDOMScanner_PayloadGeneration/javascript:_Protocol
=== RUN   TestDOMScanner_PayloadGeneration/jQuery_Sink
--- PASS: TestDOMScanner_PayloadGeneration (0.00s)
    --- PASS: TestDOMScanner_PayloadGeneration/innerHTML_Sink (0.00s)
    --- PASS: TestDOMScanner_PayloadGeneration/eval_Sink (0.00s)
    --- PASS: TestDOMScanner_PayloadGeneration/location_Sink (0.00s)
    --- PASS: TestDOMScanner_PayloadGeneration/javascript:_Protocol (0.00s)
    --- PASS: TestDOMScanner_PayloadGeneration/jQuery_Sink (0.00s)
=== RUN   TestGenerateDOMPayload
=== RUN   TestGenerateDOMPayload/innerHTML_sink_should_not_return_script
=== RUN   TestGenerateDOMPayload/outerHTML_sink_should_not_return_script
=== RUN   TestGenerateDOMPayload/eval_sink_should_return_JS
--- PASS: TestGenerateDOMPayload (0.00s)
    --- PASS: TestGenerateDOMPayload/innerHTML_sink_should_not_return_script (0.00s)
    --- PASS: TestGenerateDOMPayload/outerHTML_sink_should_not_return_script (0.00s)
    --- PASS: TestGenerateDOMPayload/eval_sink_should_return_JS (0.00s)
=== RUN   TestDOMScanner_ScanDOM
=== RUN   TestDOMScanner_ScanDOM/No_Vulnerability
=== RUN   TestDOMScanner_ScanDOM/Basic_DOM_XSS
=== RUN   TestDOMScanner_ScanDOM/Multiple_DOM_XSS
=== RUN   TestDOMScanner_ScanDOM/Taint_Analysis:_Variable_Assignment
=== RUN   TestDOMScanner_ScanDOM/Taint_Analysis:_Transitive
=== RUN   TestDOMScanner_ScanDOM/New_Source:_localStorage
=== RUN   TestDOMScanner_ScanDOM/Sanitization_(Should_be_Safe)
=== RUN   TestDOMScanner_ScanDOM/Scope_Isolation_(Should_be_Safe)
=== RUN   TestDOMScanner_ScanDOM/Scope_Isolation_(Should_be_Unsafe)
=== RUN   TestDOMScanner_ScanDOM/Complex_Expression_(Concatenation)
=== RUN   TestDOMScanner_ScanDOM/Modern_Source:_navigation.currentEntry
=== RUN   TestDOMScanner_ScanDOM/Modern_Sink:_navigation.navigate
=== RUN   TestDOMScanner_ScanDOM/jQuery_Sink:_.html()
=== RUN   TestDOMScanner_ScanDOM/Prototype_Pollution:___proto___assignment
=== RUN   TestDOMScanner_ScanDOM/Prototype_Pollution:_Bracket_notation
--- PASS: TestDOMScanner_ScanDOM (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/No_Vulnerability (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/Basic_DOM_XSS (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/Multiple_DOM_XSS (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/Taint_Analysis:_Variable_Assignment (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/Taint_Analysis:_Transitive (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/New_Source:_localStorage (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/Sanitization_(Should_be_Safe) (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/Scope_Isolation_(Should_be_Safe) (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/Scope_Isolation_(Should_be_Unsafe) (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/Complex_Expression_(Concatenation) (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/Modern_Source:_navigation.currentEntry (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/Modern_Sink:_navigation.navigate (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/jQuery_Sink:_.html() (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/Prototype_Pollution:___proto___assignment (0.00s)
    --- PASS: TestDOMScanner_ScanDOM/Prototype_Pollution:_Bracket_notation (0.00s)
=== RUN   TestDOMScanner_ScanDeepDOM_Caching
--- PASS: TestDOMScanner_ScanDeepDOM_Caching (0.00s)
=== RUN   TestDOMScanner_ScanDeepDOM
=== RUN   TestDOMScanner_ScanDeepDOM/External_Vulnerable_JS
=== RUN   TestDOMScanner_ScanDeepDOM/External_Safe_JS
=== RUN   TestDOMScanner_ScanDeepDOM/Mixed_Inline_and_External
--- PASS: TestDOMScanner_ScanDeepDOM (0.00s)
    --- PASS: TestDOMScanner_ScanDeepDOM/External_Vulnerable_JS (0.00s)
    --- PASS: TestDOMScanner_ScanDeepDOM/External_Safe_JS (0.00s)
    --- PASS: TestDOMScanner_ScanDeepDOM/Mixed_Inline_and_External (0.00s)
FAIL
FAIL	github.com/lcalzada-xor/xxss/v2/pkg/scanner/dom	0.019s
=== RUN   TestReproBinaryExpressionSink
    binary_expression_test.go:27: Found 1 findings
    binary_expression_test.go:29: Finding: location.search -> document.write
--- PASS: TestReproBinaryExpressionSink (0.00s)
=== RUN   TestBootstrapFalsePositives
=== RUN   TestBootstrapFalsePositives/Bootstrap_3.3.7_Style_-_jQuery.fn_assignment
=== RUN   TestBootstrapFalsePositives/Direct_Prototype_Assignment_-_Safe
=== RUN   TestBootstrapFalsePositives/Constructor_Prototype_Assignment_-_Safe
=== RUN   TestBootstrapFalsePositives/Unsafe___proto___Assignment_-_Static
=== RUN   TestBootstrapFalsePositives/Unsafe___proto___Assignment_-_Dynamic
=== RUN   TestBootstrapFalsePositives/Bootstrap_Real_Snippet
=== RUN   TestBootstrapFalsePositives/Prototype_Overwrite_-_Static
--- PASS: TestBootstrapFalsePositives (0.00s)
    --- PASS: TestBootstrapFalsePositives/Bootstrap_3.3.7_Style_-_jQuery.fn_assignment (0.00s)
    --- PASS: TestBootstrapFalsePositives/Direct_Prototype_Assignment_-_Safe (0.00s)
    --- PASS: TestBootstrapFalsePositives/Constructor_Prototype_Assignment_-_Safe (0.00s)
    --- PASS: TestBootstrapFalsePositives/Unsafe___proto___Assignment_-_Static (0.00s)
    --- PASS: TestBootstrapFalsePositives/Unsafe___proto___Assignment_-_Dynamic (0.00s)
    --- PASS: TestBootstrapFalsePositives/Bootstrap_Real_Snippet (0.00s)
    --- PASS: TestBootstrapFalsePositives/Prototype_Overwrite_-_Static (0.00s)
=== RUN   TestFetchPromiseDetection
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Visiting node type: *ast.FunctionDeclaration
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.BinaryExpression
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: fetch
[VV] DOM: Tainted fetch() result from source 'window.location.search'
[VV] DOM: Visiting node type: *ast.ArrowFunctionLiteral
[VV] DOM: Visiting node type: *ast.ExpressionBody
[VV] DOM: CallExpression callee resolved to: fetch().then
[VV] DOM: Tainting param 'response' in .then() callback from source 'window.location.search'
[VV] DOM: Visiting node type: *ast.ArrowFunctionLiteral
[VV] DOM: Tainted param 'response' in arrow function scope with source 'window.location.search'
[VV] DOM: Visiting node type: *ast.ExpressionBody
[VV] DOM: Visiting node type: *ast.ArrowFunctionLiteral
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: eval
[VV] DOM: CallExpression callee resolved to: fetch().then().then
[VV] DOM: Tainting param 'data' in .then() callback from source 'window.location.search'
[VV] DOM: Visiting node type: *ast.ArrowFunctionLiteral
[VV] DOM: Tainted param 'data' in arrow function scope with source 'window.location.search'
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: lookupTaint('data') found 'window.location.search' in scope 2
[VV] DOM: Function 'eval' called with tainted arg[0] ('data') from 'window.location.search'
[VV] DOM: CallExpression callee resolved to: eval
[VV] DOM: lookupTaint('data') found 'window.location.search' in scope 2
[VV] DOM: SINK DETECTED! eval() called with window.location.search (line 8)
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 3 potential global accesses: map[fetch:true location:true window:true]
--- PASS: TestFetchPromiseDetection (0.00s)
=== RUN   TestGTMFalsePositives
=== RUN   TestGTMFalsePositives/GTM_location.href_as_key
=== RUN   TestGTMFalsePositives/GTM_location.href_directly
=== RUN   TestGTMFalsePositives/Generic_tainted_key_(window.name)
--- PASS: TestGTMFalsePositives (0.00s)
    --- PASS: TestGTMFalsePositives/GTM_location.href_as_key (0.00s)
    --- PASS: TestGTMFalsePositives/GTM_location.href_directly (0.00s)
    --- PASS: TestGTMFalsePositives/Generic_tainted_key_(window.name) (0.00s)
=== RUN   TestRealLabDetection
    lab_repro_test.go:38: Found 1 findings
    lab_repro_test.go:40: Finding: window.location.search -> document.write
--- PASS: TestRealLabDetection (0.00s)
=== RUN   TestPrototypePollutionClassification
=== RUN   TestPrototypePollutionClassification/Static_Assignment_(Low_Risk)
=== RUN   TestPrototypePollutionClassification/Dynamic_Key_Assignment_(High_Risk)
=== RUN   TestPrototypePollutionClassification/Tainted_Value_Assignment_(High_Risk)
=== RUN   TestPrototypePollutionClassification/Safe_Prototype_Extension_(Should_be_Ignored)
--- PASS: TestPrototypePollutionClassification (0.00s)
    --- PASS: TestPrototypePollutionClassification/Static_Assignment_(Low_Risk) (0.00s)
    --- PASS: TestPrototypePollutionClassification/Dynamic_Key_Assignment_(High_Risk) (0.00s)
    --- PASS: TestPrototypePollutionClassification/Tainted_Value_Assignment_(High_Risk) (0.00s)
    --- PASS: TestPrototypePollutionClassification/Safe_Prototype_Extension_(Should_be_Ignored) (0.00s)
=== RUN   TestLab2Detection
[VV] DOM: Starting Pass 1 - Collecting tainted function calls
[VV] DOM: Starting Pass 2 - Analyzing function declarations
[VV] DOM: Visiting node type: *ast.FunctionDeclaration
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.VariableStatement
[VV] DOM: Visiting node type: *ast.Binding
[VV] DOM: Visiting node type: *ast.NewExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.AssignExpression
[VV] DOM: Visiting AssignExpression
[VV] DOM: Registered pending callback for 'xhr' (Func Ptr: 0xc000013db0)
[VV] DOM: Checking assignment to 'xhr.onreadystatechange'
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.FunctionLiteral
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.IfStatement
[VV] DOM: Visiting node type: *ast.BinaryExpression
[VV] DOM: Visiting node type: *ast.BinaryExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.ThisExpression
[VV] DOM: Visiting node type: *ast.NumberLiteral
[VV] DOM: Visiting node type: *ast.BinaryExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.ThisExpression
[VV] DOM: Visiting node type: *ast.NumberLiteral
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.BinaryExpression
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.ThisExpression
[VV] DOM: CallExpression callee resolved to: eval
[VV] DOM: Tainting variable 'searchResultsObj' from eval declaration with responseText
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: lookupTaint('searchResultsObj') found 'xhr.responseText' in scope 2
[VV] DOM: Function 'displaySearchResults' called with tainted arg[0] ('searchResultsObj') from 'xhr.responseText'
[VV] DOM: CallExpression callee resolved to: displaySearchResults
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: Visiting node type: *ast.BinaryExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: xhr.open
[VV] DOM: XHR 'xhr' tainted via open() with tainted URL 'window.location.search'
[VV] DOM: Processing 1 pending callbacks for 'xhr'
[VV] DOM: Tainting 'this' in pending callback with source 'window.location.search'
[VV] DOM: Visiting node type: *ast.FunctionLiteral
[VV] DOM: Tainted 'this' in function scope with source 'window.location.search'
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.IfStatement
[VV] DOM: Visiting node type: *ast.BinaryExpression
[VV] DOM: Visiting node type: *ast.BinaryExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.ThisExpression
[VV] DOM: Visiting node type: *ast.NumberLiteral
[VV] DOM: Visiting node type: *ast.BinaryExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.ThisExpression
[VV] DOM: Visiting node type: *ast.NumberLiteral
[VV] DOM: Visiting node type: *ast.BlockStatement
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.BinaryExpression
[VV] DOM: Visiting node type: *ast.StringLiteral
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.ThisExpression
[VV] DOM: CallExpression callee resolved to: eval
[VV] DOM: lookupTaint('this') found 'window.location.search' in scope 2
[VV] DOM: SINK DETECTED! eval() called with window.location.search (line 6)
[VV] DOM: lookupTaint('this') found 'window.location.search' in scope 2
[VV] DOM: Tainting variable 'searchResultsObj' from eval declaration with source 'window.location.search'
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: lookupTaint('searchResultsObj') found 'window.location.search' in scope 2
[VV] DOM: Function 'displaySearchResults' called with tainted arg[0] ('searchResultsObj') from 'window.location.search'
[VV] DOM: CallExpression callee resolved to: displaySearchResults
[VV] DOM: Visiting node type: *ast.ExpressionStatement
[VV] DOM: Visiting node type: *ast.CallExpression
[VV] DOM: Visiting node type: *ast.DotExpression
[VV] DOM: Visiting node type: *ast.Identifier
[VV] DOM: CallExpression callee resolved to: xhr.send
[VV] DOM: Starting Global Variable Extraction
[VV] DOM: Found 6 potential global accesses: map[XMLHttpRequest:true displaySearchResults:true eval:true location:true searchResultsObj:true window:true]
    xhr_taint_test.go:37: Found 1 findings
    xhr_taint_test.go:39: Finding: window.location.search -> eval
--- PASS: TestLab2Detection (0.00s)
PASS
ok  	github.com/lcalzada-xor/xxss/v2/pkg/scanner/dom/analysis	(cached)
FAIL
